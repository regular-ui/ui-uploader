!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.RGUI=t():e.RGUI=t()}(this,function(){return function(e){function t(s){if(n[s])return n[s].exports;var a=n[s]={exports:{},id:s,loaded:!1};return e[s].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})})},function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Uploader=void 0;var a=n(2),i=s(a),o=n(4);s(o);t.Uploader=i["default"]},function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(!function(){var e=new Error('Cannot find module "rgui-ui-base"');throw e.code="MODULE_NOT_FOUND",e}()),i=n(3),o=s(i),d={kB:1e3,MB:Math.pow(1e3,2),GB:Math.pow(1e3,3),TB:Math.pow(1e3,4)},r=a.Component.extend({name:"uploader",template:o["default"],config:function(){this.defaults({url:"",contentType:"multipart/form-data",dataType:"json",data:{},name:"file",extensions:null,maxSize:"",sending:!1,_id:(new Date).getTime()}),this.supr()},upload:function(){this.data.disabled||this.data.sending||this.$refs.file.click()},_checkExtensions:function(e){if(!this.data.extensions)return!0;var t=e.name,n=t.substring(t.lastIndexOf(".")+1,t.length).toLowerCase(),s=this.data.extensions;return"string"==typeof s&&(s=s.split(",")),!!s.includes(n)||(!(!s.includes("noext")||n.includes("."))||(this.$emit("error",{sender:this,name:"ExtensionError",message:"只能上传"+s.join(", ")+"类型的文件！",extensions:s}),!1))},_checkSize:function(e){if(!this.data.maxSize&&0!==this.data.maxSize)return!0;var t=void 0;if(isNaN(this.data.maxSize)){var n=this.data.maxSize.slice(-2);if(!d[n])throw new Error("Unknown unit!");t=this.data.maxSize.slice(0,-2)*d[n]}else t=+this.data.maxSize;return e.size<=t||(this.$emit("error",{sender:this,name:"SizeError",message:"文件大小超出限制！",maxSize:this.data.maxSize,size:e.size}),!1)},_submit:function(){var e=this,t=this.$refs.file.files?this.$refs.file.files[0]:{name:this.$refs.file.value,size:0};if(t&&t.name&&this._checkExtensions(t)&&this._checkSize(t)){this.data.sending=!0;var n=t.name;if(this.data.file={name:n,extName:n.indexOf(".")!==-1?n.substring(n.lastIndexOf(".")+1,n.length).toLowerCase():void 0,size:t.size},this.$emit("sending",{sender:this,data:this.data.data}),"undefined"==typeof FormData)this.$refs.form.submit();else{var s=new XMLHttpRequest,a=new FormData(this.$refs.form);s.open("POST",this.data.url),s.upload.onprogress=function(e){e.lengthComputable&&this.$emit("progress",{sender:this,data:{loaded:e.loaded,total:e.total}})}.bind(this),s.onreadystatechange=function(){if(4==s.readyState)if(200==s.status)e._onLoad(s.responseText,s.responseXML);else{if(!e.data.sending)return;e.data.sending=!1,e.data.file=null,e.$emit("error",{sender:e,name:"ResponseError",message:"No responseText!"})}},s.send(a)}}},_onLoad:function(e,t){if(this.$refs){var n=this.$refs.iframe,s=this.data.file;if(this.data.sending){this.data.sending=!1,this.data.file=null;var a={};if(e||t?(a.responseText=e,a.responseXML=t):n.contentWindow?(a.responseText=n.contentWindow.document.body?n.contentWindow.document.body.innerText:null,a.responseXML=n.contentWindow.document.XMLDocument?n.contentWindow.document.XMLDocument:n.contentWindow.document):n.contentDocument&&(a.responseText=n.contentDocument.document.body?n.contentDocument.document.body.innerText:null,a.responseXML=n.contentDocument.document.XMLDocument?n.contentDocument.document.XMLDocument:n.contentDocument.document),!a.responseText)return this.$emit("error",{sender:this,name:"ResponseError",message:"No responseText!"});this.$emit("complete",{sender:this,xml:a}),this.$emit("success",{sender:this,data:this._parseData(a,this.data.dataType),file:s})}}},_parseData:function(e,t){if("text"===t)return e.responseText;if("xml"===t)return e.responseXML;if("json"===t){var n=e.responseText;try{n=JSON.parse(n)}catch(s){}return n}return e.responseText}});t["default"]=r},function(e,t){e.exports=[{type:"element",tag:"div",attrs:[{type:"attribute",name:"class",value:{type:"expression",body:"['u-uploader ',c._sg_('class', d, e)].join('')",constant:!1,setbody:!1}},{type:"attribute",name:"z-dis",value:{type:"expression",body:"c._sg_('disabled', d, e)",constant:!1,setbody:"c._ss_('disabled',p_,d, '=', 1)"}},{type:"attribute",name:"r-hide",value:{type:"expression",body:"(!c._sg_('visible', d, e))",constant:!1,setbody:!1}}],children:[{type:"text",text:"\n    "},{type:"element",tag:"div",attrs:[{type:"attribute",name:"on-click",value:{type:"expression",body:"c['upload']()",constant:!1,setbody:!1}}],children:[{type:"text",text:"\n        "},{type:"template",content:{type:"expression",body:"c._sg_('$body', c)",constant:!1,setbody:"c._ss_('$body',p_,c, '=', 0)"}},{type:"text",text:"\n    "}]},{type:"text",text:"\n    "},{type:"element",tag:"form",attrs:[{type:"attribute",name:"method",value:"POST"},{type:"attribute",name:"action",value:{type:"expression",body:"c._sg_('url', d, e)",constant:!1,setbody:"c._ss_('url',p_,d, '=', 1)"}},{type:"attribute",name:"target",value:{type:"expression",body:"['iframe',c._sg_('_id', d, e)].join('')",constant:!1,setbody:!1}},{type:"attribute",name:"enctype",value:{type:"expression",body:"c._sg_('contentType', d, e)",constant:!1,setbody:"c._ss_('contentType',p_,d, '=', 1)"}},{type:"attribute",name:"ref",value:"form"}],children:[{type:"text",text:"\n        "},{type:"if",test:{type:"expression",body:"(!c._sg_('sending', d, e))",constant:!1,setbody:!1},consequent:[{type:"text",text:"\n        \n        "},{type:"element",tag:"input",attrs:[{type:"attribute",name:"type",value:"file"},{type:"attribute",name:"name",value:{type:"expression",body:"c._sg_('name', d, e)",constant:!1,setbody:"c._ss_('name',p_,d, '=', 1)"}},{type:"attribute",name:"ref",value:"file"},{type:"attribute",name:"on-change",value:{type:"expression",body:"c['_submit']()",constant:!1,setbody:!1}}]},{type:"text",text:"\n        "}],alternate:[]},{type:"text",text:"\n        "},{type:"list",sequence:{type:"expression",body:"Object['keys'](c._sg_('data', d, e))",constant:!1,setbody:!1},alternate:[],variable:"key",body:[{type:"text",text:"\n        "},{type:"element",tag:"input",attrs:[{type:"attribute",name:"type",value:"hidden"},{type:"attribute",name:"name",value:{type:"expression",body:"c._sg_('key', d, e)",constant:!1,setbody:"c._ss_('key',p_,d, '=', 1)"}},{type:"attribute",name:"value",value:{type:"expression",body:"c._sg_(c._sg_('key', d, e), c._sg_('data', d, e))",constant:!1,setbody:"c._ss_(c._sg_('key', d, e),p_,c._sg_('data', d, e), '=', 0)"}}]},{type:"text",text:"\n        "}]},{type:"text",text:"\n    "}]},{type:"text",text:"\n    "},{type:"element",tag:"iframe",attrs:[{type:"attribute",name:"name",value:{type:"expression",body:"['iframe',c._sg_('_id', d, e)].join('')",constant:!1,setbody:!1}},{type:"attribute",name:"on-load",value:{type:"expression",body:"c['_onLoad']()",constant:!1,setbody:!1}},{type:"attribute",name:"ref",value:"iframe"}]},{type:"text",text:"\n"}]}]},function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(!function(){var e=new Error('Cannot find module "rgui-ui-base"');throw e.code="MODULE_NOT_FOUND",e}()),i=(n(2),n(5)),o=s(i),d=n(6),r=s(d),p=n(7),c=s(p),l=a.Component.extend({name:"uploaderPro",template:o["default"],config:function(){this.defaults({message:"uploaderPro",fileList:[],fileTemplate:r["default"],uploadTemplate:c["default"]}),this.supr()},_onInput:function(e){this.$emit("input",e)},_onSuccess:function(e){var t=Object.assign({},e.file);t.data=e.data,this._addFiles(t),this.$emit("success",{sender:this,data:e.data,file:e.file})},_onError:function(e){this.$emit("error",{sender:this,name:"ResponseError",message:"No responseText!"})},_addFiles:function(e){e instanceof Array?(this.data.fileList.concat(e),this.$emit("fileAdd",{file:e})):(this.data.fileList.push(e),this.$emit("fileAdd",{file:[e]}))},_removeFiles:function(e){var t=this.data.fileList.splice(e,1);this.$emit("fileDel",{file:t})},getFileList:function(){return Array.from(this.data.fileList)},clearFileList:function(){this.data.fileList=[],this.$update()}});t["default"]=l},function(e,t){e.exports=[{type:"element",tag:"div",attrs:[{type:"attribute",name:"class",value:{type:"expression",body:"['uploader-pro ',c._sg_('clazz', d, e)||c._sg_('class', d, e)].join('')",constant:!1,setbody:!1}},{type:"attribute",name:"r-class",value:{type:"expression",body:"{'z-dis':c._sg_('disabled', d, e)}",constant:!1,setbody:!1}}],children:[{type:"text",text:"\n    "},{type:"list",sequence:{type:"expression",body:"c._sg_('fileList', d, e)",constant:!1,setbody:"c._ss_('fileList',p_,d, '=', 1)"},alternate:[],variable:"file",body:[{type:"text",text:"\n        "},{type:"element",tag:"div",attrs:[{type:"attribute",name:"class",value:{type:"expression",body:"['item file-',c._sg_('extName', c._sg_('file', d, e))].join('')",constant:!1,setbody:!1}}],children:[{type:"text",text:"\n            "},{type:"template",content:{type:"expression",body:"c._sg_('fileTemplate', d, e)",constant:!1,setbody:"c._ss_('fileTemplate',p_,d, '=', 1)",once:!0}},{type:"text",text:"\n        "}]},{type:"text",text:"\n    "}]},{type:"text",text:"\n    "},{type:"element",tag:"uploader",attrs:[{type:"attribute",name:"url",value:{type:"expression",body:"c._sg_('url', d, e)",constant:!1,setbody:"c._ss_('url',p_,d, '=', 1)"}},{type:"attribute",name:"extensions",value:{type:"expression",body:"c._sg_('extensions', d, e)",constant:!1,setbody:"c._ss_('extensions',p_,d, '=', 1)"}},{type:"attribute",name:"maxSize",value:{type:"expression",body:"c._sg_('maxSize', d, e)",constant:!1,setbody:"c._ss_('maxSize',p_,d, '=', 1)"}},{type:"attribute",name:"disabled",value:{type:"expression",body:"c._sg_('disabled', d, e)",constant:!1,setbody:"c._ss_('disabled',p_,d, '=', 1)"}},{type:"attribute",name:"on-success",value:{type:"expression",body:"c['_onSuccess'](c._sg_('$event', d, e))",constant:!1,setbody:!1}},{type:"attribute",name:"on-error",value:{type:"expression",body:"c['_onError'](c._sg_('$event', d, e))",constant:!1,setbody:!1}},{type:"attribute",name:"dataType",value:{type:"expression",body:"c._sg_('dataType', d, e)",constant:!1,setbody:"c._ss_('dataType',p_,d, '=', 1)"}}],children:[{type:"text",text:"\n        "},{type:"template",content:{type:"expression",body:"c._sg_('uploadTemplate', d, e)",constant:!1,setbody:"c._ss_('uploadTemplate',p_,d, '=', 1)",once:!0}},{type:"text",text:"\n    "}]},{type:"text",text:"\n"}]}]},function(e,t){e.exports=[{type:"element",tag:"div",attrs:[{type:"attribute",name:"class",value:"file-item"}],children:[{type:"text",text:"\n    "},{type:"element",tag:"span",attrs:[{type:"attribute",name:"class",value:"delete"},{type:"attribute",name:"on-click",value:{type:"expression",body:"(!c._sg_('disabled', d, e))?c['_removeFiles'](c._sg_('file_index', d, e)):''",constant:!1,setbody:!1}}],children:[]},{type:"text",text:"\n    "},{type:"element",tag:"i",attrs:[{type:"attribute",name:"class",value:"extName"}],children:[{type:"expression",body:"c._sg_('extName', c._sg_('file', d, e))||'?'",constant:!1,setbody:!1}]},{type:"text",text:"\n    "},{type:"element",tag:"i",attrs:[{type:"attribute",name:"class",value:{type:"expression",body:"['icon icon-',c._sg_('extName', c._sg_('file', d, e))].join('')",constant:!1,setbody:!1}}],children:[]},{type:"text",text:"\n    "},{type:"element",tag:"p",attrs:[{type:"attribute",name:"class",value:"file-name"}],children:[{type:"expression",body:"c._sg_('name', c._sg_('file', d, e))",constant:!1,setbody:"c._ss_('name',p_,c._sg_('file', d, e), '=', 0)"}]},{type:"text",text:"\n"}]}]},function(e,t){e.exports=[{type:"element",tag:"div",attrs:[{type:"attribute",name:"class",value:"uploader-btn"}],children:[{type:"text",text:"\n+\n"}]}]}])});